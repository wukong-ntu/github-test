<!DOCTYPE HTML>
<html lang="zh-tw" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>實作 | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        <meta name="author" content="WuKong Project">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../styles/website.css">
    

        
    
    
    <link rel="next" href="../06-Wuclass/Grove.html" />
    
    
    <link rel="prev" href="../06-Wuclass/Definition.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="6.3"
        data-chapter-title="實作"
        data-filepath="06-Wuclass/Implement.md"
        data-basepath=".."
        data-revision="Tue Jun 14 2016 17:49:05 GMT+0800 (CST)"
        data-innerlanguage="zh-tw">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="version_history.html">
            
                
                    <a href="../version_history.html">
                
                        <i class="fa fa-check"></i>
                        
                        更新日誌
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        第1章: 悟空中介軟體簡介
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="01-HowToUse/index.html">
            
                
                    <a href="../01-HowToUse/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        如何使用這本書
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="02-Server/index.html">
            
                
                    <a href="../02-Server/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        第2章: 設定伺服器環境
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="03-Board/index.html">
            
                
                    <a href="../03-Board/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        第3章: 物聯網開發板
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="03-Board/Edison.html">
            
                
                    <a href="../03-Board/Edison.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        設定Intel Edison
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="03-Board/Galileo.html">
            
                
                    <a href="../03-Board/Galileo.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        設定Intel Galileo Gen 2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="03-Board/RPi.html">
            
                
                    <a href="../03-Board/RPi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        設定Raspberry Pi Board
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="04-Examples/index.html">
            
                
                    <a href="../04-Examples/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        第4章: 範例
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="04-Examples/Music.html">
            
                
                    <a href="../04-Examples/Music.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        電腦上的範例 - 音樂播放器
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="04-Examples/OP1/master-gateway.html">
            
                
                    <a href="../04-Examples/OP1/master-gateway.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        步驟1. 啟動主控台及通訊閘程式
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="04-Examples/OP1/device.html">
            
                
                    <a href="../04-Examples/OP1/device.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        步驟2. 新增裝置
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="04-Examples/OP1/fbp.html">
            
                
                    <a href="../04-Examples/OP1/fbp.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.3.</b>
                        
                        步驟3. 撰寫資料流程式
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="04-Examples/OP1/run.html">
            
                
                    <a href="../04-Examples/OP1/run.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.4.</b>
                        
                        步驟4. 執行程式
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="04-Examples/OP1/issue.html">
            
                
                    <a href="../04-Examples/OP1/issue.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.5.</b>
                        
                        尋找裝置問題
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="04-Examples/LED.html">
            
                
                    <a href="../04-Examples/LED.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        物聯網開發板 - 控制LED
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="04-Examples/OP2/master-gateway.html">
            
                
                    <a href="../04-Examples/OP2/master-gateway.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        步驟1. 啟動主控台及通訊閘程式
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="04-Examples/OP2/device.html">
            
                
                    <a href="../04-Examples/OP2/device.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.</b>
                        
                        步驟2. 新增裝置
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="04-Examples/OP2/fbp.html">
            
                
                    <a href="../04-Examples/OP2/fbp.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.3.</b>
                        
                        步驟3. 撰寫資料流程式
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="04-Examples/OP2/run.html">
            
                
                    <a href="../04-Examples/OP2/run.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.4.</b>
                        
                        步驟4. 執行程式
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="05-Web/index.html">
            
                
                    <a href="../05-Web/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        第5章: 悟空管理介面
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="05-Web/Network.html">
            
                
                    <a href="../05-Web/Network.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        網路管理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="05-Web/Device.html">
            
                
                    <a href="../05-Web/Device.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        裝置管理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="05-Web/App.html">
            
                
                    <a href="../05-Web/App.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        應用程式管理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="05-Web/AppStore.html">
            
                
                    <a href="../05-Web/AppStore.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        應用程式商店
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="06-Wuclass/index.html">
            
                
                    <a href="../06-Wuclass/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        第6章: 動手寫悟空類別元件
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="06-Wuclass/Framework.html">
            
                
                    <a href="../06-Wuclass/Framework.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        悟空屬性架構
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="06-Wuclass/Definition.html">
            
                
                    <a href="../06-Wuclass/Definition.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        定義
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="6.3" data-path="06-Wuclass/Implement.html">
            
                
                    <a href="../06-Wuclass/Implement.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        實作
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="06-Wuclass/Grove.html">
            
                
                    <a href="../06-Wuclass/Grove.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        範例 - Grove 模組
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="07-Advanced/index.html">
            
                
                    <a href="../07-Advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        第7章: 進階範例
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="07-Advanced/TCP.html">
            
                
                    <a href="../07-Advanced/TCP.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        TCP伺服器連線
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="07-Advanced/WebClient.html">
            
                
                    <a href="../07-Advanced/WebClient.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Web客戶端WuClass
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="07-Advanced/WebServer.html">
            
                
                    <a href="../07-Advanced/WebServer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Web伺服器端WuClass
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    本書使用 GitBook 釋出
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="63-&#x5BE6;&#x4F5C;&#x609F;&#x7A7A;&#x985E;&#x5225;">6.3 &#x5BE6;&#x4F5C;&#x609F;&#x7A7A;&#x985E;&#x5225;</h2>
<p>&#x5728;&#x9019;&#x4E00;&#x7AE0;&#x7BC0;&#x4E2D;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x642D;&#x914D;<a href="../04-Examples/LED.html">4.2&#x7BC0;</a>&#x7684;&#x8CC7;&#x6599;&#x6D41;&#x7DE8;&#x7A0B;&#x7BC4;&#x4F8B;&#x4F86;&#x4ECB;&#x7D39;&#x5982;&#x4F55;&#x5BE6;&#x4F5C;&#x609F;&#x7A7A;&#x985E;&#x5225;&#xFF0C;&#x5BE6;&#x4F5C;&#x51FA;&#x4F86;&#x7684;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x53EF;&#x4EE5;&#x540C;&#x6642;&#x7528;&#x65BC;Edison, Galileo&#x548C;Raspberry Pi&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#x5982;&#x540C;<a href="../05-Web/Device.html">5.2&#x7BC0;</a>&#x6240;&#x8FF0;&#x3002;  </p>
<h4 id="&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7684;python&#x6A23;&#x7248;"><strong>&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7684;Python&#x6A23;&#x7248;</strong></h4>
<p>&#x4EE5;&#x4E0B;&#x7232;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7684;&#x6A23;&#x7248;&#xFF0C;&#x5F9E;&#x6A23;&#x7248;&#x4E2D;&#x53EF;&#x770B;&#x5230;&#xFF0C;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x6703;&#x52A0;&#x5165;&#x609F;&#x7A7A;&#x985E;&#x5225;(addClass)&#xFF0C;&#x4E26;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;(addObject)&#x3002;&#x76EE;&#x524D;&#x6240;&#x6709;&#x7684;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7A0B;&#x5F0F;&#x90FD;&#x5B58;&#x653E;&#x5728;<code>https://github.com/wukong-m2m/wukong-darjeeling/tree/release0.4/wukong/gateway/udpwkpf</code></p>
<pre><code class="lang-python">  <span class="hljs-keyword">from</span> twisted.internet <span class="hljs-keyword">import</span> reactor
  <span class="hljs-keyword">from</span> udpwkpf <span class="hljs-keyword">import</span> WuClass, Device
  <span class="hljs-keyword">import</span> sys

  <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
      <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XXX</span><span class="hljs-params">(WuClass)</span>:</span>
          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
              WuClass.__init__(self)
              self.loadClass(<span class="hljs-string">&apos;XXX&apos;</span>)

          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self,obj,pID=None,val=None)</span>:</span>
              <span class="hljs-keyword">pass</span>

      <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDevice</span><span class="hljs-params">(Device)</span>:</span>
          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self,addr,localaddr)</span>:</span>
              Device.__init__(self,addr,localaddr)

          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span><span class="hljs-params">(self)</span>:</span>
              cls = XXX()
              self.addClass(cls,<span class="hljs-number">0</span>)
              self.addObject(cls.ID)

      d = MyDevice(sys.argv[<span class="hljs-number">1</span>],sys.argv[<span class="hljs-number">2</span>])
      reactor.run()
</code></pre>
<h4 id="&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7BC4;&#x4F8B;&#x7A0B;&#x5F0F;&#xFF1A;&#x6309;&#x9215;&#x548C;&#x71C8;&#x5149;"><strong>&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7BC4;&#x4F8B;&#x7A0B;&#x5F0F;&#xFF1A;&#x6309;&#x9215;&#x548C;&#x71C8;&#x5149;</strong></h4>
<p>&#x6B64;&#x7BC4;&#x4F8B;&#x7A0B;&#x5F0F;&#x662F;&#x6839;&#x64DA;&#x4EE5;&#x4E0A;&#x7684;&#x6A23;&#x7248;&#x6240;&#x5BEB;&#x6210;&#xFF0C;&#x5728;&#x6B64;&#x88DD;&#x7F6E;&#x6A23;&#x7248;&#x4E2D;&#x5BE6;&#x4F5C;&#x4E86;&#x5169;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#xFF0C;&#x4E00;&#x500B;&#x662F;&#x7B2C;10&#x884C;&#x7684;&#x6309;&#x9215;(Button)&#xFF0C;&#x53E6;&#x4E00;&#x500B;&#x662F;&#x7B2C;25&#x884C;&#x7684;&#x71C8;&#x5149;(Light_Actuator)&#xFF0C;&#x6709;&#x4E86;&#x9019;&#x5169;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x7684;&#x5BE6;&#x4F5C;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x7167;&#x8005;4.2&#x7BC0;&#x7684;&#x6B65;&#x9A5F;&#x4F86;&#x90E8;&#x7F72;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x5F80;&#x4E0B;&#x770B;&#x7A0B;&#x5F0F;&#x4E4B;&#x524D;&#xFF0C;&#x5EFA;&#x8B70;&#x53EF;&#x4EE5;&#x5148;&#x7167;&#x8005;4.2&#x7BC0;&#x6240;&#x8FF0;&#x7684;&#x6B65;&#x9A5F;&#x64CD;&#x4F5C;&#x4E00;&#x904D;&#xFF0C;&#x5C07;&#x6709;&#x52A9;&#x65BC;&#x5C0D;&#x6B64;&#x7A0B;&#x5F0F;&#x7684;&#x7406;&#x89E3;&#x3002;&#x63A5;&#x8005;&#xFF0C;&#x6BCF;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x90FD;&#x6709;&#x521D;&#x59CB;&#x51FD;&#x5F0F;(init)&#x8207;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;(update)&#xFF0C;&#x521D;&#x59CB;&#x51FD;&#x5F0F;&#x662F;&#x7528;&#x4F86;&#x8A2D;&#x5B9A;&#x5404;&#x8B8A;&#x6578;,&#x72C0;&#x614B;&#x8207;&#x786C;&#x9AD4;&#x53C3;&#x6578;&#x7684;&#x8D77;&#x59CB;&#x503C;&#xFF0C;&#x800C;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;&#x5247;&#x662F;&#x7528;&#x4F86;&#x88AB;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x91CD;&#x8986;&#x5730;&#x547C;&#x53EB;&#x57F7;&#x884C;&#x3002;&#x6700;&#x5F8C;&#xFF0C;&#x7576;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7BC4;&#x4F8B;&#x7A0B;&#x5F0F;&#x88AB;&#x57F7;&#x884C;&#x5F8C;&#xFF0C;&#x9019;&#x5169;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x5C07;&#x6703;&#x88AB;&#x52A0;&#x5165;(addClass)&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x4E2D;&#xFF0C;&#x4E26;&#x7528;&#x4F86;&#x7522;&#x751F;(addObject)&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#x3002;   </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/python_wuclass_blink_led_1_new.png" alt="">
  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/python_wuclass_blink_led_2_new.png" alt=""></p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/python_wuclass_blink_led_3_new.png" alt=""></p>
<p> <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no1.png" alt="">&#x7232;&#x4E86;&#x900F;&#x904E;GPIO&#x63A7;&#x5236;&#x6309;&#x9215;&#x548C;&#x71C8;&#x5149;&#xFF0C;&#x6211;&#x5011;&#x9700;&#x8981;&#x5728;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x6700;&#x524D;&#x9762;&#x532F;&#x5165;(import)&#x7269;&#x806F;&#x7DB2;&#x958B;&#x767C;&#x677F;&#x7684;GPIO&#x51FD;&#x5F0F;&#x5EAB;&#xFF0C;&#x800C;&#x4E14;&#xFF0C;&#x7232;&#x4E86;&#x76E1;&#x53EF;&#x80FD;&#x8B93;&#x540C;&#x4E00;&#x500B;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7A0B;&#x5F0F;&#x80FD;&#x57F7;&#x884C;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7269;&#x806F;&#x7DB2;&#x958B;&#x767C;&#x677F;&#xFF0C;&#x6211;&#x5011;&#x65B0;&#x589E;&#x4E86;&#x9019;&#x500B;&#x4ECB;&#x9762;(udpdevice_io_interface.py)&#x4F86;&#x6C7A;&#x5B9A;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E09;&#x500B;&#x4E0D;&#x540C;&#x7684;GPIO&#x51FD;&#x5F0F;&#x5EAB;&#xFF0C;&#x4E0B;&#x4E00;&#x500B;&#x7AE0;&#x7BC0;&#x6703;&#x7E7C;&#x7E8C;&#x8AAA;&#x660E;&#x9019;&#x500B;GPIO&#x4ECB;&#x9762;&#x3002;<br><!-- ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no1.png)Since we control button and LED through gpio, we need to import the gpio library for the IoT board. To make this template work with various IoT boards, we create an interface to define how to use gpio. We will see more about this interface in the next section.  -->   </p>
<p> <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no2.png" alt="">&#x9019;&#x500B;&#x51FD;&#x5F0F;&#x7684;&#x8F38;&#x5165;&#x53C3;&#x6578;&#x5FC5;&#x9808;&#x662F;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x7684;&#x540D;&#x7A31;&#xFF0C;&#x4E26;&#x4E14;&#xFF0C;&#x6B64;&#x540D;&#x7A31;&#x8981;&#x8207;WuKongStandardLibrary.xml&#x6240;&#x5B9A;&#x7FA9;&#x7684;&#x540D;&#x7A31;&#x76F8;&#x540C;&#xFF0C;&#x7576;&#x9019;&#x500B;&#x51FD;&#x5F0F;&#x53D6;&#x5F97;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x540D;&#x7A31;&#x5F8C;&#xFF0C;&#x5C31;&#x6703;&#x5206;&#x6790;WuKongStandardLibrary.xml&#x6240;&#x5B9A;&#x7FA9;&#x7684;&#x5167;&#x5BB9;&#xFF0C;&#x622A;&#x53D6;&#x9019;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x7684;&#x6BCF;&#x500B;&#x53C3;&#x6578;&#x3002;<br><!-- ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no2.png)The input argument of self.loadClass function must be a WuClass name defined in the WuKongStandardLibrary.xml. With WuClass name, this function will parse all its attributes from WuKongStandardLibrary.xml file.-->             </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no3.png" alt="">&#x4F7F;&#x7528;&#x7B2C;1&#x9EDE;&#x6240;&#x63D0;&#x7684;GPIO&#x4ECB;&#x9762;&#x4F86;&#x8A2D;&#x5B9A;&#x54EA;&#x500B;GPIO&#x8173;&#x4F4D;&#x6703;&#x88AB;&#x7528;&#x5230;&#xFF0C;&#x4E26;&#x8A2D;&#x5B9A;&#x8A72;&#x8173;&#x4F4D;&#x662F;&#x6578;&#x4F4D;(digital)&#x9084;&#x662F;&#x985E;&#x6BD4;(analog)&#xFF0C;&#x4EE5;&#x53CA;&#x8A2D;&#x5B9A;&#x662F;&#x8F38;&#x5165;(input)&#x6216;&#x8F38;&#x51FA;(output)&#x3002;
<!-- ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no3.png)Use the function of udpwkpf_io_interface.py to specify which gpio pin will be used. We also specify whether this pin is digital or analog, and whether its direction is input or output.-->  </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no4.png" alt="">&#x7531;&#x65BC;&#x5728;6.2&#x7BC0;&#x4E2D;&#xFF0C;&#x6309;&#x9215;&#x611F;&#x6E2C;&#x5668;&#x6709;&#x5B9A;&#x7FA9;&#x5237;&#x65B0;&#x901F;&#x5EA6;(refresh rate)&#x5C6C;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;(update)&#x6703;&#x5B9A;&#x671F;&#x88AB;&#x57F7;&#x884C;&#x4E26;&#x900F;&#x904E;GPIO&#x8B80;&#x53D6;&#x5176;&#x611F;&#x6E2C;&#x5230;&#x7684;&#x503C;&#x3002;
<!--  ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no4.png)Since button is a sensor, the update function should be run periodically to read sensing data from gpio. For this reason, we have defined a property with refresh_rate datatype for the button WuClass, so the update function of the button WuClass will be called by WKPF regularly.-->       </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no5.png" alt="">setProperty&#x51FD;&#x5F0F;&#x662F;&#x7528;&#x4F86;&#x5C07;&#x67D0;&#x5C6C;&#x6027;&#x7684;&#x503C;&#x5BEB;&#x5165;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x7684;&#x5C6C;&#x6027;&#x5132;&#x5B58;&#x5340;&#xFF0C;&#x7576;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x76E3;&#x6E2C;&#x5230;&#x6B64;&#x5C6C;&#x6027;&#x7684;&#x503C;&#x6539;&#x8B8A;&#x5F8C;&#xFF0C;&#x5C31;&#x6703;&#x6309;&#x7167;&#x8CC7;&#x6599;&#x6D41;&#x8868;&#x55AE;&#x4F86;&#x50B3;&#x905E;&#x503C;&#x3002;setProperty&#x51FD;&#x5F0F;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x662F;&#x5C6C;&#x6027;&#x8FA8;&#x5225;&#x865F;(property ID, pID)&#xFF0C;&#x5728;&#x7B2C;20&#x884C;&#x4E2D;&#xFF0C;pID&#x7B49;&#x65BC;&#x96F6;&#x8868;&#x793A;&#x6309;&#x9215;&#x7684;&#x7B2C;1&#x500B;&#x5C6C;&#x6027;&#x7684;&#x503C;&#x5C07;&#x88AB;&#x5BEB;&#x5165;&#x5C6C;&#x6027;&#x5132;&#x5B58;&#x5340;&#xFF0C;&#x82E5;&#x6211;&#x5011;&#x5C0D;&#x7167;WuKongStandardLibrary.xml&#xFF0C;&#x53EF;&#x77E5;&#x9053;&#x6309;&#x9215;&#x7684;&#x7B2C;1&#x500B;&#x5C6C;&#x6027;&#x662F;current_value&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8AAA;&#xFF0C;&#x6309;&#x9215;&#x7684;&#x611F;&#x6E2C;&#x6578;&#x503C;&#x6703;&#x88AB;&#x5BEB;&#x5165;&#x5C6C;&#x6027;&#x5132;&#x5B58;&#x5340;&#x3002;<br><!--  ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no5.png)The **setProperty** function of button will send its value to WKPF which then propagates the value according to the data link of FBP. The first parameter of setProperty function is pID. In this example, pID=0 indicates the first property of button, which is current_value (you can confirm with the WuKongStandardLibrary.xml). That is, the current_value is going to be propagated.-->   </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no6.png" alt="">&#x7531;&#x65BC;&#x71C8;&#x5149;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x6C92;&#x6709;&#x5B9A;&#x7FA9;&#x5237;&#x65B0;&#x901F;&#x5EA6;(refresh rate)&#xFF0C;&#x6240;&#x4EE5;&#x71C8;&#x5149;&#x7684;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;&#x53EA;&#x6703;&#x5728;&#x5176;&#x5C6C;&#x6027;&#x7684;&#x503C;&#x6539;&#x8B8A;&#x6642;&#x88AB;&#x547C;&#x53EB;&#x3002;&#x4EE5;4.2&#x7BC0;&#x7684;&#x7BC4;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x7576;&#x6309;&#x9215;&#x88AB;&#x6309;&#x4E0B;&#x53BB;&#x6642;&#xFF0C;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x6703;&#x77E5;&#x9053;&#x6309;&#x9215;&#x7684;&#x7B2C;1&#x500B;&#x5C6C;&#x6027;&#x7684;&#x503C;&#x5DF2;&#x6539;&#x8B8A;&#xFF0C;&#x65BC;&#x662F;&#x5C31;&#x7167;&#x7740;&#x8CC7;&#x6599;&#x6D41;&#x6E05;&#x55AE;&#x628A;&#x503C;&#x50B3;&#x905E;&#x7D66;&#x71C8;&#x5149;&#x5C6C;&#x6027;&#x5132;&#x5B58;&#x5340;&#xFF0C;&#x4E26;&#x4E14;&#x547C;&#x53EB;&#x71C8;&#x5149;&#x7684;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;&#xFF0C;&#x7576;&#x51FD;&#x5F0F;&#x88AB;&#x57F7;&#x884C;&#x6642;&#xFF0C;&#x5C31;&#x6703;&#x7167;&#x8005;&#x8B80;&#x53D6;&#x5230;&#x7684;&#x503C;&#x4F86;&#x958B;&#x95DC;&#x71C8;&#x5149;&#x3002;&#x5728;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x547C;&#x53EB;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;&#x6642;&#xFF0C;&#x540C;&#x6642;&#x4E5F;&#x6703;&#x50B3;&#x905E;&#x6539;&#x8B8A;&#x7684;<strong>obj</strong>(&#x609F;&#x7A7A;&#x7269;&#x4EF6;),<strong>pID</strong>(&#x5C6C;&#x6027;&#x8B58;&#x5225;&#x865F;)&#x548C;<strong>value</strong>(&#x503C;)&#x7D66;&#x66F4;&#x65B0;&#x51FD;&#x5F0F;&#x505A;&#x904B;&#x7528;&#x3002;<br><!--  ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no6.png)This update function will be called whenever there is a new data propagated to the light actuator. And because we doesn't define a property with refresh_rate for the light actuator, its update function will only run responsively. For example, in the FBP of Ch4.2, when button is pressed, its value will propagate through data link to light actuator. And then, the update function of light actuator will be called by WKPF. WKPF also passes three parameters including **obj**(WuObject of light actuator), **pID**(which property of WuObject going to be updated), and **value**.  After being called, the update function will turn on or off the light actutator responsively.-->         </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no7.png" alt="">&#x9019;&#x500B;&#x51FD;&#x5F0F;&#x7232;&#x7528;&#x4F86;&#x52A0;&#x5165;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x5230;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#xFF0C;&#x5728;&#x9019;&#x500B;&#x7BC4;&#x4F8B;&#x7A0B;&#x5F0F;&#x4E2D;&#xFF0C;&#x6309;&#x9215;&#x548C;&#x71C8;&#x5149;&#x5747;&#x52A0;&#x5165;&#x5230;&#x540C;&#x4E00;&#x500B;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x7A0B;&#x5F0F;&#xFF0C;&#x6240;&#x4EE5;&#x6703;&#x5171;&#x540C;&#x4F7F;&#x7528;&#x4E00;&#x500B;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x3002;&#x95DC;&#x65BC;&#x6B64;&#x51FD;&#x5F0F;&#x7684;&#x7B2C;2&#x500B;&#x8F38;&#x5165;&#x53C3;&#x6578;&#xFF0C;&#x662F;&#x7528;&#x4F86;&#x8868;&#x793A;&#x9019;&#x500B;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x53EF;&#x5426;&#x81EA;&#x884C;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#xFF0C;&#x96F6;&#x4EE3;&#x8868;&#x6B64;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x4E0D;&#x80FD;&#x81EA;&#x884C;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x7528;&#x4E0B;&#x4E00;&#x884C;&#x7684;&#x51FD;&#x5F0F;(addObject)&#x4F86;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#x3002;&#x5728;7.3&#x7BC0;&#x6642;&#xFF0C;&#x6211;&#x5011;&#x5C07;&#x6703;&#x4F7F;&#x7528;&#x5230;&#x80FD;&#x81EA;&#x884C;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#x7684;&#x609F;&#x7A7A;&#x985E;&#x5225;&#xFF0C;&#x5C46;&#x6642;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x7528;addObject&#x4F86;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;&#x3002;<br><!--  ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no7.png)Add WuClass to the WuClass list of the WuKong device so that this WuClass will share the same WKPF as other WuClasses on a node. About the second parameter of addClass function, this value indicates whether this WuClass can be used to create objects. "0" means this WuClass can't create objects. That's why we use addObject function in the next line to create an object(self.obj_button) for the device. In the Ch7.3, we will use a WuClass which can create objects.-->    </p>
<p>  <img src="https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no8.png" alt="">&#x7531;&#x65BC;&#x5C6C;&#x6027;&#x67B6;&#x69CB;&#x7684;&#x5BE6;&#x4F5C;&#x662F;&#x7528;Python&#x7684;Twisted&#x51FD;&#x5F0F;&#x5EAB;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x5F8C;&#x8A18;&#x5F97;&#x8981;&#x52A0;&#x9019;&#x884C;&#x7A0B;&#x5F0F;&#xFF0C;&#x5426;&#x5247;&#x6309;&#x9215;&#x7684;&#x503C;&#x4E0D;&#x6703;&#x88AB;&#x5B9A;&#x671F;&#x66F4;&#x65B0;&#x3002;<br><!--  ![](https://raw.githubusercontent.com/wukong-ntu/wukong-gitbook-figures/master/figures/06-Wuclass/no8.png)Don't forget to add **reactor.run()** or else the value of button will neither be refreshed periodically nor be propagated to light actuator through data link.-->   </p>
<h4 id="&#x8981;&#x9EDE;"><strong>&#x8981;&#x9EDE;</strong></h4>
<p>&#x9019;&#x4E00;&#x7AE0;&#x7BC0;&#x7684;&#x6700;&#x5F8C;&#xFF0C;&#x6211;&#x5011;&#x6B78;&#x7D0D;&#x51FA;&#x5BE6;&#x4F5C;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x7684;&#x5E7E;&#x500B;&#x8981;&#x9EDE;&#xFF1A;    </p>
<ul>
<li>&#x9996;&#x5148;&#x662F;&#x65B0;&#x589E;&#x4E26;&#x4EFF;&#x7167;&#x609F;&#x7A7A;&#x88DD;&#x7F6E;&#x6A23;&#x7248;&#x5230;&lt;<em>path_of_source_code</em>&gt;/wukong/gateway/udpwkpf/udpdevice_XXX.py   </li>
<li>&#x82E5;&#x662F;&#x8981;&#x65B0;&#x589E;&#x611F;&#x6E2C;&#x5668;(sensor)&#xFF0C;&#x8ACB;&#x53C3;&#x8003;&#x6309;&#x9215;&#x7684;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x5BEB;&#x6CD5;;&#x82E5;&#x662F;&#x8981;&#x65B0;&#x589E;&#x63A7;&#x5236;&#x5668;(acutator)&#xFF0C;&#x8ACB;&#x53C3;&#x8003;&#x71C8;&#x5149;&#x7684;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x5BEB;&#x6CD5;&#x3002;   </li>
<li>&#x6700;&#x5F8C;&#x52A0;&#x5165;&#x609F;&#x7A7A;&#x985E;&#x5225;&#x5230;&#x88DD;&#x7F6E;&#x4E0A;(addClass)&#xFF0C;&#x4E26;&#x5728;&#x88DD;&#x7F6E;&#x4E0A;&#x7522;&#x751F;&#x609F;&#x7A7A;&#x7269;&#x4EF6;(addObject)&#x3002;  </li>
</ul>
<!--
###**Summary**  
In this section, we show the steps to implement the Python code for an IoT device:   
  * Copy the template to a new file as  <*path_of_source_code*>/wukong/gateway/udpwkpf/udpdevice_XXX.py  
  * Write a WuClass for each of the sensors according to the pattern of Button, or write a WuClass for actuator according to the pattern of Light_Actuator.  
  * Add WuClass to MyDevice and use this WuClass to create an object on the device.-->  

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../06-Wuclass/Definition.html" class="navigation navigation-prev " aria-label="Previous page: 定義"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../06-Wuclass/Grove.html" class="navigation navigation-next " aria-label="Next page: 範例 - Grove 模組"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
